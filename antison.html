<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #000; margin: 0; overflow: hidden; position: fixed; width: 100%; height: 100%; }
        video { position: fixed; width: 1px; height: 1px; opacity: 0; pointer-events: none; }
    </style>
</head>
<body>
    <video id="v" playsinline muted loop></video>
    <script>
        const tg = window.Telegram.WebApp;
        const v = document.getElementById('v');
        let wl = null;

        // Функция активации антисна
        const wake = async () => {
            // Сбрасываем старый лок перед запросом нового
            if (wl) {
                try { await wl.release(); } catch(e) {}
                wl = null;
            }

            // Запрос системного Wake Lock (Android)
            if ('wakeLock' in navigator) {
                try { wl = await navigator.wakeLock.request('screen'); } catch(e) {}
            }

            // Запуск видео-хака (iOS)
            if (!v.src) v.src = "data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21hdmMxbXA0MgAAAAhmcmVlAAAALm1kYXQAAAHvYXZjQwFQAFr/4AAZAWgAVv/AAB9AAAADAAIAAAMAHBDeEAEABWj/gAAAAA5ieHRyY3Rsc3RyYmMAAAALYm9vdnNoZHIAAAADbXZoZAAAAAAAAAAAAAAAAAAAA+gAAAPoAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAGlzb21hdmMxbXA0MgAAAAhmcmVlAAAALm1kYXQ=";
            v.play().catch(() => {});
        };

        tg.ready();
        tg.expand();
        if (tg.isVersionAtLeast('7.7')) tg.disableVerticalSwipes();

        // Слушаем события для реактивации после включения экрана
        // visibilitychange - когда вкладка становится видимой
        // focus - когда окно получает фокус
        ['touchstart', 'click', 'visibilitychange', 'focus'].forEach(e => 
            document.addEventListener(e, () => {
                if (document.visibilityState === 'visible' || e !== 'visibilitychange') {
                    wake();
                }
            })
        );
        
        // Начальный запуск
        wake();
    </script>
</body>
</html>